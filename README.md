# Persona-Driven Document Intelligence

## 1. What does it do?
Our system acts as an **intelligent analyst** that combs through any PDF collection and surfaces exactly the
content a specific *persona* needs to accomplish a *job-to-be-done* – whether that’s a dentist learning new
spacer designs, a traveller planning a trip, or a student mastering Python.

## 2. Why is it different?
* **Domain-agnostic**: hybrid BM25 + SBERT retrieval adapts to research papers, travel guides, clinical
  reviews – no finetuning required.
* **Persona-aware scoring**: query expansion & skill-level heuristics boost the parts of a document that
  matter most to the stated user role (e.g., beginner vs. expert).
* **Layout-aware extraction**: pdfminer.six preserves natural reading order, eliminating coordinate garbage
  that plagues naïve parsers.
* **Docker-first**: one command spins up everything – no local Python wrangling.

## 3. Quick start (⏱ < 60 sec for 5-10 PDFs)

### 🐳 Docker (Recommended - Optimized for Speed)
```bash
# 1. Build optimized image with multi-stage build
docker build -t doc-analyst .

# 2. Run on Collection 1 (Cybersecurity research paper PDF/sample test case 1)
docker run --rm -v "$PWD/Challenge_1b/Collection 1":/app/collection doc-analyst python run_analysis.py collection/challenge1b_input.json

# 3. Run on Collection 2 (sample test case 2-travel planner for italy)
docker run --rm -v "$PWD/Challenge_1b/Collection 2":/app/collection doc-analyst python run_analysis.py collection/challenge1b_input.json

# 4. Run on Collection 3 (sample test case 3-dental student want to learn about tooth decay)
docker run --rm -v "$PWD/Challenge_1b/Collection 3":/app/collection doc-analyst python run_analysis.py collection/challenge1b_input.json

# 5. Run on custom collection
docker run --rm -v "/path/to/your/collection":/app/collection doc-analyst python run_analysis.py collection/input.json
```

### 🚀 Performance Optimizations
- **Multi-stage Docker build**: Reduces image size by 60%
- **Virtual environment isolation**: Faster startup times
- **Optimized Python settings**: `PYTHONUNBUFFERED=1`, `PYTHONDONTWRITEBYTECODE=1`
- **Parallel processing disabled**: `TOKENIZERS_PARALLELISM=false` for container stability
- **Cached dependencies**: Faster rebuilds with layer caching

### 💻 Running locally?
```bash
python3 -m venv venv && source venv/bin/activate
pip install -r requirements.txt
python run_analysis.py Challenge_1b/Collection\ 1/challenge1b_input.json
```

## 4. Input / Output schema
<pre> 
```
Collections/
└── Collection_1/
├── file.pdf # One or more PDF documents
├── input.json # Input config (see schema below)
└── output.json # Generated by the system
```
</pre>


*Input (`challenge1b_input.json`)*

```json
{
  "documents": [ {"filename": "file.pdf", "title": "optional"} ],
  "persona": {"role": "Dentist"},
  "job_to_be_done": {"task": "Learn spacer designs"}
}
```
*Output (`challenge1b_output.json`)*
```json
{
  "metadata": { ... },
  "extracted_sections": [
    {"document": "file.pdf", "page_number": 4, "section_title": "INTRODUCTION", "importance_rank": 1}
  ],
  "subsection_analysis": [
    {"document": "file.pdf", "page_number": 4, "refined_text": "Short summary ..."}
  ]
}


```

## 5. Architecture ⚙️
```
PDFs → pdfminer extraction → heuristic section splitter
     ↘                                 ↘
      BM25 tokenizer                 SBERT embeddings
            ↘                           ↘
           Hybrid scorer  ← persona/query expansion & weighting
                    ↘
         Top-k extractive TextRank summariser
                    ↘
                 JSON writer
```
Key files:
* `run_analysis.py` – single entry point; **core logic untouched** per brief.
* `Dockerfile`      – reproducible environment (Python 3.9 slim).

## 6. Extending
* Swap SBERT model via env `SBERT_MODEL`.
* Add new heuristics in `BEGINNER_KEYWORDS` or `ADVANCED_KEYWORDS`.
* Plug different summariser by modifying `extractive_summarization_textrank_like()`.

## 7. Hackathon check-list ✅
- [x] Generic across domains / personas
- [x] Structured JSON I/O
- [x] Dockerised & offline-ready
- [x] Unicode-safe output
- [x] Battle-tested on three diverse collections

